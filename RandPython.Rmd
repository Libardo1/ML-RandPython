---
title: "RandPython"
author: "Tinniam V Ganesh"
date: "October 3, 2017"
output:
  html_document: default
  word_document: default
---

```{r}
trainTestSplit <- function(df,trainPercent,seed1){
    ## Sample size percent
    samp_size <- floor(trainPercent/100 * nrow(df))
    
    ## set the seed to make your partition reproductible
    ## set the seed to make your partition reproductible
    set.seed(seed1)
    idx <- sample(seq_len(nrow(df)), size = samp_size)
    idx

}

Rsquared <- function(lmfit,newdf,y){
  yhat <- predict(lmfit,newdata=newdf)
  RSS <- sum((y - yhat)^2)
  TSS <- sum((y - mean(y))^2)
  rsquared <-1 - (RSS/TSS)
  rsquared
}


df=read.csv("Boston.csv",stringsAsFactors = FALSE) # Data from MASS - SL
train_idx <- trainTestSplit(df,trainPercent=75,seed=5)
train <- df[train_idx, ]
test <- df[-train_idx, ]


fit=lm(medv~lstat,data=df)
fit
summary(fit)
confint(fit)
plot(df$lstat,df$medv)
abline(fit)
abline(fit,lwd=3)
abline(fit,lwd=3,col="red")
```

```{python}
import numpy as np
import pandas as pd
import os
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
os.chdir("C:\\software\\machine-learning\\RandPython")
df = pd.read_csv("Boston.csv",encoding = "ISO-8859-1")
X=df['lstat']
y=df['medv']
X_train, X_test, y_train, y_test = train_test_split(X, y,random_state = 0)
X_train=X_train.values.reshape(-1,1)
X_test=X_test.values.reshape(-1,1)
from sklearn.linear_model import LinearRegression

linreg = LinearRegression().fit(X_train, y_train)
print('linear model coeff (w): {}'
     .format(linreg.coef_))
print('linear model intercept (b): {:.3f}'
     .format(linreg.intercept_))
print('R-squared score (training): {:.3f}'
     .format(linreg.score(X_train, y_train)))
print('R-squared score (test): {:.3f}'
     .format(linreg.score(X_test, y_test)))
     

fig=plt.scatter(X_train,y_train)
plt.plot()
# Create a range of points. Compute yhat=coeff1*x + intercept and plot
x=np.linspace(0,40,20)
plt.plot(x, linreg.coef_ * x + linreg.intercept_, color='red')
#plt.show()
fig.figure.savefig('foo.png', bbox_inches='tight')
print "finished"

```


Output image:
![output](foo.png)



```{r}
trainTestSplit <- function(df,trainPercent,seed1){
    ## Sample size percent
    samp_size <- floor(trainPercent/100 * nrow(df))
    
    ## set the seed to make your partition reproductible
    ## set the seed to make your partition reproductible
    set.seed(seed1)
    idx <- sample(seq_len(nrow(df)), size = samp_size)
    idx

}

Rsquared <- function(lmfit,newdf,y){
  yhat <- predict(lmfit,newdata=newdf)
  RSS <- sum((y - yhat)^2)
  TSS <- sum((y - mean(y))^2)
  rsquared <-1 - (RSS/TSS)
  rsquared
}
crimesDF <- read.csv("crimes.csv",stringsAsFactors = FALSE)
names(crimesDF)
#crimesDF1 <- sapply(crimesDF,as.numeric)
crimesDF1 <- crimesDF[,7:length(crimesDF)]

# Conert all to numeric
crimesDF2 <- sapply(crimesDF1,as.numeric)

# Check for NAs
a <- is.na(crimesDF2)
# Set to 0 as an imputation
crimesDF2[a] <-0
crimesDF2 <- as.data.frame(crimesDF2)
train_idx <- trainTestSplit(crimesDF2,trainPercent=75,seed=5)
train <- crimesDF2[train_idx, ]
test <- crimesDF2[-train_idx, ]

fit <- lm(ViolentCrimesPerPop~poly(names(train)[1:122],2),data=train)
fit <- lm(ViolentCrimesPerPop~poly(as.matrix(train[1:120],2)),data=train)
fit.2 <- lm(ViolentCrimesPerPop~.,data=train)
summary(fit)
          
#Rsquared(fit,test,test$ViolentCrimesPerPop)

```





